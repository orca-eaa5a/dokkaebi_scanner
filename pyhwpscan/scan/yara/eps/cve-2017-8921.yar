rule EPS_CVE_2017_8291_S1{
    meta:
        description = "EPS vulnerability CVE-2017-8921 #s1"
        ref = "asec.ahnlab.com/ko/1315/"
        author = "orca.eaa5a"
        tag = "EPS.Heur.CVE-2017-8291 R1"
    strings:
        $cvx = "cvx"
        $exec_cmd = "exec"

    condition:
        $cvx and ($exec_cmd in (@cvx..@cvx+0x20))
}

rule EPS_CVE_2017_8291_S2{
    meta:
        description = "EPS vulnerability CVE-2017-8921 #s2"
        ref = "github.com/rapid7/metasploit-framework/blob/master/data/exploits/CVE-2017-8291/msf.eps"
        author = "orca.eaa5a"
        tag = "EPS.Heur.CVE-2017-8291 R2"
        
    strings:
        $pipe_str = "OutputFile (%pipe%"

        $metasploit_sig1 = ".eqproc"
        $metasploit_sig2 = "currentdevice"
        $metasploit_sig3 = "sdevice"
        $metasploit_sig4 = ".putdeviceparams"
        $metasploit_sig5 = "buffersearchvars"
    condition:
        $pipe_str or 2 of ($metasploit_sig1, $metasploit_sig2, $metasploit_sig3, $metasploit_sig4, $metasploit_sig5)
}
