rule EPS_CVE_2013_0808_S1{
    meta:
        description = "EPS vulnerability CVE-2013-0808 #s1"
        ref = "hauri.co.kr/information/analysis_view.html?intSeq=14558&page=1"
        author = "orca.eaa5a"
        tag = "EPS.Sig.CVE-2013-0808 R1"
    strings:
        /*
        $nop_sled0 = {90 90 90 90 90 90 90 90}
        $nop_sled1 = {04 84 04 84 04 84 04 84 04 84 04 84 04 84 04 84}
        $nop_sled2 = {1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B 1B}
        $nop_sled3 = {5B 5B 5B 5B 5B 5B 5B 5B 1B 1B 1B 1B 1B 1B 1B 1B}
        $nop_sled4 = {30 30 30 30 30 30 30 30}
        */
        $version_check = "/revision[a-zA-Z0-9 ]*860[a-zA-Z0-9 {]*quit/"
        $heap_spray_code1 = "65535 string dup 0 D40 putinterval"
    condition:
        any of them
}

rule EPS_CVE_2013_0808_S2{
    meta:
        description = "EPS vulnerability CVE-2013-0808 RokRAT"
        author = "orca.eaa5a"
        tag = "EPS.Heur.RokRAT"

    strings:
        $app_data = "appdata" nocase
        $tmp = "temp" nocase
        $envstr = "envstr" nocase
        $MZ_signature = "MZ" nocase
        $closefile = "closefile" nocase
        $vbs_ext = ".vbs" nocase
        $exec = "exec" nocase
        $path = "path" nocase
        $write = "write" nocase
        $vbs_str1 = "FileSystemObject" nocase

    condition:
        3 of them
}