rule PARA_TEXT_CVE_2015_6585_R1{
    meta:
        description = "HWP Paratext vulnerability"
        ref = "fireeye.com/content/dam/fireeye-www/global/en/blog/threat-research/FireEye_HWP_ZeroDay.pdf"
        author = "orca.eaa5a"
        tag = "exploit.HWP_PARATEXT.CVE-2015-6585 S1"
    strings:
        $hp_ctrl = {00 02 6c 64 63 6f ca c8 05 50 00 00 00 00 00 02}
        $hp_secPr = {00 02 63 64 73 65 79 d8 01 e1 00 00 00 00 00 02}
        $hp_t = {00 31 00 31}
        $vul_unicode1 = {10 00}
        $vul_unicode2 = {12 1c}
        
    condition:
        $hp_ctrl and ($hp_secPr in (@hp_ctrl[0]..0x21)) and ($hp_t in (@hp_ctrl[0]..0x16)) and ($vul_unicode1 in (@hp_t[0]..0x8)) and ($vul_unicode2 in (@vul_unicode1[0]..0x8))
}

rule PARA_TEXT_CVE_2015_6585_R2{
    meta:
        description = "HWP Paratext vulnerability"
        ref = "fireeye.com/content/dam/fireeye-www/global/en/blog/threat-research/FireEye_HWP_ZeroDay.pdf"
        author = "orca.eaa5a"
        tag = "exploit.HWP_PARATEXT.CVE-2015-6585 S2"
    strings:
        $hp_t = "<hp:t>"
        $vul_unicode1 = {E1 80 80}
        $vul_unicode2 = {E1 88 9C}
        
    condition:
        //all of them
        $hp_t and ($vul_unicode1 in (@hp_t..@hp_t+0x100) and $vul_unicode2 in (@hp_t..@hp_t+0x100))
}